import requests
import matplotlib.pyplot as plt
from datetime import datetime

# 1. API Integration: Fetch Bitcoin market chart (past 7 days)
url = "https://api.coingecko.com/api/v3/coins/bitcoin/market_chart"
params = {
    'vs_currency': 'usd',
    'days': '7',
    'interval': 'hourly'
}

response = requests.get(url, params=params)
data = response.json()

# 2. Data Processing: Extract timestamps and prices
timestamps = [entry[0] for entry in data['prices']]
prices = [entry[1] for entry in data['prices']]
dates = [datetime.fromtimestamp(ts / 1000) for ts in timestamps]  # Convert ms to seconds

# 3. Data Visualization
plt.figure(figsize=(12, 6))
plt.plot(dates, prices, label='BTC Price (USD)', color='orange')
plt.title("Bitcoin Price Over Last 7 Days (Hourly)")
plt.xlabel("Date")
plt.ylabel("Price (USD)")
plt.grid(True)
plt.legend()
plt.tight_layout()
plt.xticks(rotation=45)
plt.show()
